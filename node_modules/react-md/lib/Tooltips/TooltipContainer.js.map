{"version":3,"sources":["../../src/js/Tooltips/TooltipContainer.js"],"names":["getContainer","tooltip","parentNode","TooltipContainer","state","visible","_delayedTimeout","_unlinkTarget","target","_target","_showTooltip","_hideTooltip","removeEventListener","_handleKeyUp","_setTarget","container","_container","props","addEventListener","_setContainers","span","_stopContextMenu","e","preventDefault","window","setState","type","_touched","delay","clearTimeout","setTimeout","which","keyCode","prevProps","style","className","tooltipStyle","tooltipClassName","label","position","enterTimeout","leaveTimeout","propTypes","object","string","node","isRequired","number","func","oneOfType","defaultProps"],"mappings":"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","file":"TooltipContainer.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport TransitionGroup from 'react-transition-group/TransitionGroup';\nimport cn from 'classnames';\n\nimport { TAB } from '../constants/keyCodes';\nimport captureNextEvent from '../utils/EventUtils/captureNextEvent';\nimport { addTouchEvent, removeTouchEvent } from '../utils/EventUtils/touches';\nimport Tooltip from './Tooltip';\n\n\nfunction getContainer(tooltip) {\n  return tooltip.parentNode;\n}\n\nexport default class TooltipContainer extends PureComponent {\n  static propTypes = {\n    style: PropTypes.object,\n    className: PropTypes.string,\n    tooltipStyle: PropTypes.object,\n    tooltipClassName: PropTypes.string,\n    label: PropTypes.node.isRequired,\n    position: Tooltip.propTypes.position,\n    delay: PropTypes.number,\n    enterTimeout: Tooltip.propTypes.enterTimeout,\n    leaveTimeout: Tooltip.propTypes.leaveTimeout,\n    /**\n     * A function that returns a DOM element that will be used as the tooltip's container.\n     * A ref to the tooltip's DOM element will be passed into the function.\n     */\n    container: PropTypes.func,\n    /**\n     * A component/element the tooltip should be linked to,\n     * or a function that returns such a component/element.\n     * A ref to the tooltip's container will be passed into the function.\n     *\n     * By default the tooltip's container will be used as the target.\n     */\n    target: PropTypes.oneOfType([\n      PropTypes.object,\n      PropTypes.func,\n    ]),\n  };\n\n  static defaultProps = {\n    container: getContainer,\n    delay: 0,\n  };\n\n  state = { visible: false };\n\n  componentDidMount() {\n    this._setTarget();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.target !== prevProps.target) {\n      this._setTarget();\n    }\n  }\n\n  componentWillUnmount() {\n    this._unlinkTarget();\n    this._target = null;\n\n    if (this._delayedTimeout) {\n      clearTimeout(this._delayedTimeout);\n    }\n  }\n\n  _delayedTimeout = null;\n\n  _unlinkTarget = () => {\n    const target = this._target;\n    if (target) {\n      removeTouchEvent(target, 'start', this._showTooltip);\n      removeTouchEvent(target, 'end', this._hideTooltip);\n      target.removeEventListener('mouseover', this._showTooltip);\n      target.removeEventListener('mouseleave', this._hideTooltip);\n      target.removeEventListener('keyup', this._handleKeyUp);\n      target.removeEventListener('blur', this._hideTooltip);\n    }\n  };\n\n  _setTarget = () => {\n    const container = this._container;\n    let { target } = this.props;\n\n    this._unlinkTarget();\n\n    if (typeof target === 'function') {\n      target = target(container, this);\n    }\n    target = target ? findDOMNode(target) : container;\n    this._target = target || null;\n\n    if (target) {\n      addTouchEvent(target, 'start', this._showTooltip);\n      addTouchEvent(target, 'end', this._hideTooltip);\n      target.addEventListener('mouseover', this._showTooltip);\n      target.addEventListener('mouseleave', this._hideTooltip);\n      target.addEventListener('keyup', this._handleKeyUp);\n      target.addEventListener('blur', this._hideTooltip);\n    }\n  };\n\n  _setContainers = (span) => {\n    if (span) {\n      this._container = this.props.container(span.parentNode, this);\n    }\n  };\n\n  _stopContextMenu = (e) => {\n    e.preventDefault();\n    window.removeEventListener('contextmenu', this._stopContextMenu, true);\n    captureNextEvent('click');\n    this.setState({ visible: true });\n  };\n\n  _showTooltip = (e) => {\n    if (e.type === 'mouseover' && this._touched) {\n      return;\n    }\n\n    if (e.type === 'touchstart') {\n      this._touched = true;\n\n      window.addEventListener('contextmenu', this._stopContextMenu, true);\n      return;\n    }\n\n\n    const { delay } = this.props;\n    if (this._delayedTimeout) {\n      clearTimeout(this._delayedTimeout);\n    }\n\n    if (delay) {\n      this._delayedTimeout = setTimeout(() => {\n        this._delayedTimeout = null;\n\n        this.setState({ visible: true });\n      }, delay);\n    } else {\n      this.setState({ visible: true });\n    }\n  };\n\n  _hideTooltip = (e) => {\n    if (this._delayedTimeout) {\n      clearTimeout(this._delayedTimeout);\n    }\n\n    if (e.type === 'mouseover' && this._touched) {\n      return;\n    }\n\n    this.setState({ visible: false });\n  };\n\n  _handleKeyUp = (e) => {\n    if ((e.which || e.keyCode) === TAB) {\n      this._showTooltip(e);\n    }\n  };\n\n  render() {\n    const { visible } = this.state;\n    const {\n      style,\n      className,\n      tooltipStyle,\n      tooltipClassName,\n      label,\n      position,\n      enterTimeout,\n      leaveTimeout,\n    } = this.props;\n\n    const tooltip = (\n      <Tooltip\n        key=\"tooltip\"\n        style={tooltipStyle}\n        className={tooltipClassName}\n        position={position}\n        enterTimeout={enterTimeout}\n        leaveTimeout={leaveTimeout}\n      >\n        {label}\n      </Tooltip>\n    );\n\n    return (\n      <TransitionGroup\n        style={style}\n        className={cn('md-tooltip-container', className)}\n        component=\"div\"\n      >\n        <span ref={this._setContainers} aria-hidden />\n        {visible ? tooltip : null}\n      </TransitionGroup>\n    );\n  }\n}\n"]}